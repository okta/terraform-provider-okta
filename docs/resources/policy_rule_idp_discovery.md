---
page_title: "Resource: okta_policy_rule_idp_discovery"
description: |-
  Creates an IdP Discovery Policy Rule.
  This resource allows you to create and configure an IdP Discovery Policy Rule.
  -> If you receive the error 'You do not have permission to access the feature
  you are requesting' contact support mailto:dev-inquiries@okta.com and
  request feature flag 'ADVANCED_SSO' be applied to your org.
---

# Resource: okta_policy_rule_idp_discovery

Creates an IdP Discovery Policy Rule.
		
This resource allows you to create and configure an IdP Discovery Policy Rule.
-> If you receive the error 'You do not have permission to access the feature
you are requesting' [contact support](mailto:dev-inquiries@okta.com) and
request feature flag 'ADVANCED_SSO' be applied to your org.

## Example Usage

```terraform
### All Okta orgs contain only one IdP Discovery Policy
data "okta_policy" "idp_discovery_policy" {
  name = "Idp Discovery Policy"
  type = "IDP_DISCOVERY"
}

resource "okta_policy_rule_idp_discovery" "example" {
  policy_id                 = data.okta_policy.idp_discovery_policy.id
  name                      = "example"
  idp_id                    = "<idp id>"
  idp_type                  = "OIDC"
  network_connection        = "ANYWHERE"
  priority                  = 1
  status                    = "ACTIVE"
  user_identifier_type      = "ATTRIBUTE"
  user_identifier_attribute = "company"

  app_exclude {
    id   = "<app id>"
    type = "APP"
  }

  app_exclude {
    name = "yahoo_mail"
    type = "APP_TYPE"
  }

  app_include {
    id   = "<app id>"
    type = "APP"
  }

  app_include {
    name = "<app type name>"
    type = "APP_TYPE"
  }

  platform_include {
    type    = "MOBILE"
    os_type = "OSX"
  }

  user_identifier_patterns {
    match_type = "EQUALS"
    value      = "Articulate"
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `name` (String) Policy Rule Name

### Optional

- `app_exclude` (Block Set) Applications to exclude in discovery. See `app_include` for details. (see [below for nested schema](#nestedblock--app_exclude))
- `app_include` (Block Set) Applications to include in discovery rule.
- 'id' - (Optional) Use if 'type' is 'APP' to indicate the application id to include.
- 'name' - (Optional) Use if the 'type' is 'APP_TYPE' to indicate the type of application(s) to include in instances where an entire group (i.e. 'yahoo_mail') of applications should be included.
- 'type' - (Required) One of: 'APP', 'APP_TYPE' (see [below for nested schema](#nestedblock--app_include))
- `idp_id` (String) The identifier for the Idp the rule should route to if all conditions are met.
- `idp_type` (String) Type of Idp. One of: `SAML2`, `IWA`, `AgentlessDSSO`, `X509`, `FACEBOOK`, `GOOGLE`, `LINKEDIN`, `MICROSOFT`, `OIDC`. Default: `OKTA`
- `network_connection` (String) Network selection mode: `ANYWHERE`, `ZONE`, `ON_NETWORK`, or `OFF_NETWORK`. Default: `ANYWHERE`
- `network_excludes` (List of String) Required if `network_connection` = `ZONE`. Indicates the network zones to exclude.
- `network_includes` (List of String) Required if `network_connection` = `ZONE`. Indicates the network zones to include.
- `platform_include` (Block Set) Platform to include in discovery rule.
- 'type' - (Optional) One of: 'ANY', 'MOBILE', 'DESKTOP'
- 'os_expression - (Optional) Only available when using os_type = 'OTHER'
- 'os_type' - (Optional) One of: 'ANY', 'IOS', 'WINDOWS', 'ANDROID', 'OTHER', 'OSX' (see [below for nested schema](#nestedblock--platform_include))
- `policy_id` (String) Policy ID of the Rule
- `priority` (Number) Rule priority. This attribute can be set to a valid priority. To avoid an endless diff situation an error is thrown if an invalid property is provided. The Okta API defaults to the last (lowest) if not provided.
- `status` (String) Policy Rule Status: `ACTIVE` or `INACTIVE`. Default: `ACTIVE`
- `user_identifier_attribute` (String) Profile attribute matching can only have a single value that describes the type indicated in `user_identifier_type`. This is the attribute or identifier that the `user_identifier_patterns` are checked against.
- `user_identifier_patterns` (Block Set) Specifies a User Identifier pattern condition to match against. If 'match_type' of 'EXPRESSION' is used, only a *single* element can be set, otherwise multiple elements of matching patterns may be provided.
- 'match_type' - (Optional) The kind of pattern. For regex, use 'EXPRESSION'. For simple string matches, use one of the following: 'SUFFIX', 'EQUALS', 'STARTS_WITH', 'CONTAINS'
- 'value' - (Optional) The regex or simple match string to match against. (see [below for nested schema](#nestedblock--user_identifier_patterns))
- `user_identifier_type` (String) One of: `IDENTIFIER`, `ATTRIBUTE`

### Read-Only

- `id` (String) The ID of this resource.

<a id="nestedblock--app_exclude"></a>
### Nested Schema for `app_exclude`

Required:

- `type` (String)

Optional:

- `name` (String)

Read-Only:

- `id` (String) The ID of this resource.


<a id="nestedblock--app_include"></a>
### Nested Schema for `app_include`

Required:

- `type` (String)

Optional:

- `name` (String)

Read-Only:

- `id` (String) The ID of this resource.


<a id="nestedblock--platform_include"></a>
### Nested Schema for `platform_include`

Optional:

- `os_expression` (String) Only available with OTHER OS type
- `os_type` (String)
- `type` (String)


<a id="nestedblock--user_identifier_patterns"></a>
### Nested Schema for `user_identifier_patterns`

Optional:

- `match_type` (String)
- `value` (String)

## Import

Import is supported using the following syntax:

```shell
terraform import okta_policy_rule_idp_discovery.example <policy_id>/<rule_id>
```
